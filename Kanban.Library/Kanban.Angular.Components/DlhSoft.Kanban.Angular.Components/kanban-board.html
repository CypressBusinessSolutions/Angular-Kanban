<div class="kanban-board">
    <table class="kanban-board-container">
        <thead>
            <tr class="kanban-board-row kanban-board-states-row">
                <td class="kanban-board-cell kanban-board-header kanban-board-row-header kanban-board-column-header kanban-board-toggle-button-area"></td>
                <td ng-if="!dskb.hideGroups" class="kanban-board-cell kanban-board-header kanban-board-row-header kanban-board-column-header kanban-board-content" ng-style="{ width: dksb.groupWidth }" ng-transclude></td>
                <td ng-repeat="state in dskb.states" class="kanban-board-cell kanban-board-header kanban-board-column-header kanban-board-state-header" ng-style="{ width: state.width ? state.width : dksb.stateWidth }">
                    <ng-include src="state.templateUrl ? state.templateUrl : dskb.stateTemplateUrl"/>
                </td>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="group in dskb.groups" class="kanban-board-row kanban-board-group-row" ng-class="group.isCollapsed ? 'kanban-board-group-collapsed' : ''">
                <td class="kanban-board-cell kanban-board-header kanban-board-row-header kanban-board-toggle-button-area" ng-click="group.isCollapsed = !group.isCollapsed">
                    <svg ng-if="!group.isCollapsed" class="kanban-board-toggle-button" width="8" height="8">
                        <polygon points="1,7 7,7 7,1" class="kanban-board-toggle-button-expanded"/>
                    </svg>
                    <svg ng-if="group.isCollapsed" class="kanban-board-toggle-button" width="8" height="8">
                        <polygon points="0,0 6,4 0,8" class="kanban-board-toggle-button-collapsed"/>
                    </svg>
                </td>
                <td ng-if="!dskb.hideGroups" class="kanban-board-cell kanban-board-header kanban-board-row-header kanban-board-group-container">
                    <div ng-style="{ height: (!group.isCollapsed ? dskb.groupHeight : dskb.collapsedGroupHeight) + 'px' }" class="kanban-board-content-box" ds:kanban-item-drop-zone on-drop="dskb.onGroupDrop(itemType, index, dskb.groups.indexOf(group))">
                        <ng-include src="group.templateUrl ? group.templateUrl : (group.type && group.type.templateUrl ? group.type.templateUrl : dskb.groupTemplateUrl)"/>
                    </div>
                </td>
                <td ng-repeat="state in dskb.states" class="kanban-board-cell kanban-board-items-container">
                    <div ng-hide="group.isCollapsed" ng-style="{ height: ((!group.isCollapsed ? dskb.getItemsInGroupAndState(group, dskb.getMaxStateInGroup(group)).length : 1) * dskb.itemHeight + (!dskb.getMaxStateInGroup(group).isNewItemButtonHidden ? 26 : 0)) + 'px' }">
                        <div ng-repeat="item in dskb.getItemsInGroupAndState(group, state)" ds:kanban-item-drop-zone on-drop="dskb.onItemDrop(itemType, index, group, state, dskb.items.indexOf(item))">
                            <div ng-style="{ height: dskb.itemHeight + 'px' }" class="kanban-board-content-box">
                                <ng-include src="item.templateUrl ? item.templateUrl : (item.type && item.type.templateUrl ? item.type.templateUrl : dskb.itemTemplateUrl)"/>
                            </div>
                        </div>
                        <div class="kanban-board-commands-container" ng-style="{ height: ((dskb.getItemsInGroupAndState(group, dskb.getMaxStateInGroup(group)).length - dskb.getItemsInGroupAndState(group, state).length) * dskb.itemHeight + (!dskb.getMaxStateInGroup(group).isNewItemButtonHidden ? 26 : 0)) + 'px' }" ds:kanban-item-drop-zone on-drop="dskb.onItemDrop(itemType, index, group, state)">
                            <a ng-hide="state.isNewItemButtonHidden" href="javascript://" class="kanban-board-button kanban-board-new-item-command" ng-click="dskb.addNewItem(group, state)" title="{{ dskb.newItemButtonToolTip }}">
                                {{ dskb.newItemButtonText }}
                            </a>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>